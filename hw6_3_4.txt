use vk_dummy;

##задание 3

SELECT COUNT(*) as 'Мужчины' FROM likes 
	WHERE user_id in (
		SELECT user_id from profiles WHERE gender = 'M'
		);
	
SELECT COUNT(*) as 'Женщины' FROM likes 
	WHERE user_id in (
		SELECT user_id from profiles WHERE gender = 'F'
		);
	
	 
SELECT
	(SELECT gender FROM profiles WHERE user_id = likes.user_id) AS gender,
	COUNT(*) AS total
    FROM likes    
    GROUP BY gender;
    ORDER BY total DESC
    LIMIT 1;  
   
##задание 4

SELECT 
	id as user, 
	(SELECT COUNT(*) FROM messages WHERE messages.from_user_id = users.id) AS total_messages,
    (SELECT COUNT(*) FROM posts WHERE posts.user_id = users.id) AS total_posts,  
	(SELECT COUNT(*) FROM media WHERE media.user_id = users.id) AS total_media, 
	(SELECT COUNT(*) FROM likes WHERE likes.user_id = users.id) AS total_likes
	from users
	order by id;
